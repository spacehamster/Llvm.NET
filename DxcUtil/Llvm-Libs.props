<Project>
    <!-- VS doesn't like user macros in a property sheet with conditions -->
    <PropertyGroup>
        <!--
        Classic VS installations don't have an "x86" platform - the official name of the platform is Win32,
        However, the default VS 2017 CMake support uses x86 as a platform name. So this adapts and adjusts
        to allow for compatibility across VS tool versions.
        -->
        <LlvmPlatform Condition="'$(LlvmPlatform)'==''">$(Platform)</LlvmPlatform>
        <LlvmPlatform Condition="'$(LlvmPlatform)'=='Win32'">x86</LlvmPlatform>
        <LlvmPlatformConfig Condition="'$(LlvmPlatformConfig)'==''">$(LlvmPlatform)-$(Configuration)</LlvmPlatformConfig>
    </PropertyGroup>
    <PropertyGroup Label="UserMacros">
        <!-- These are not conditional as the version is bound directly to the version of LLVM built into the libraries -->
        <LlvmVersionMajor>3</LlvmVersionMajor>
        <llvmVersionMinor>7</llvmVersionMinor>
        <LlvmVersionBuild>0</LlvmVersionBuild>
        <LlvmVersion>$(LlvmVersionMajor).$(LlvmVersionMinor).$(LlvmVersionBuild)</LlvmVersion>
        <LlvmLibsMetaPackageRoot>$(MSBuildThisFileDirectory)</LlvmLibsMetaPackageRoot>
        <LlvmPlatformConfigLibRoot>$(LlvmLibsMetaPackageRoot)$(LlvmPlatformConfig)\$(Configuration)\lib\</LlvmPlatformConfigLibRoot>
        <LlvmPlatformConfigIncRoot>$(LlvmLibsMetaPackageRoot)$(LlvmPlatformConfig)\include\</LlvmPlatformConfigIncRoot>
        <LlvmCommonIncRoot>$(LlvmLibsMetaPackageRoot)include\</LlvmCommonIncRoot>
        <LlvmExecutionEngineOrcRoot>$(LlvmLibsMetaPackageRoot)lib\ExecutionEngine\Orc</LlvmExecutionEngineOrcRoot>
    </PropertyGroup>
    <PropertyGroup>
        <AllLlvmLibs>$(AllLlvmLibs);LLVMAnalysis.lib</AllLlvmLibs>
        <AllLlvmLibs>$(AllLlvmLibs);LLVMAsmParser.lib</AllLlvmLibs>
        <AllLlvmLibs>$(AllLlvmLibs);LLVMBitReader.lib</AllLlvmLibs>
        <AllLlvmLibs>$(AllLlvmLibs);LLVMBitWriter.lib</AllLlvmLibs>
        <AllLlvmLibs>$(AllLlvmLibs);LLVMCore.lib</AllLlvmLibs>
        <AllLlvmLibs>$(AllLlvmLibs);LLVMDxcSupport.lib</AllLlvmLibs>
        <AllLlvmLibs>$(AllLlvmLibs);LLVMDXIL.lib</AllLlvmLibs>
        <AllLlvmLibs>$(AllLlvmLibs);LLVMDxilContainer.lib</AllLlvmLibs>
        <AllLlvmLibs>$(AllLlvmLibs);LLVMDxilDia.lib</AllLlvmLibs>
        <AllLlvmLibs>$(AllLlvmLibs);LLVMDxilPIXPasses.lib</AllLlvmLibs>
        <AllLlvmLibs>$(AllLlvmLibs);LLVMDxilRootSignature.lib</AllLlvmLibs>
        <AllLlvmLibs>$(AllLlvmLibs);LLVMDxrFallback.lib</AllLlvmLibs>
        <AllLlvmLibs>$(AllLlvmLibs);LLVMHLSL.lib</AllLlvmLibs>
        <AllLlvmLibs>$(AllLlvmLibs);LLVMInstCombine.lib</AllLlvmLibs>
        <AllLlvmLibs>$(AllLlvmLibs);LLVMipa.lib</AllLlvmLibs>
        <AllLlvmLibs>$(AllLlvmLibs);LLVMipo.lib</AllLlvmLibs>
        <AllLlvmLibs>$(AllLlvmLibs);LLVMIRReader.lib</AllLlvmLibs>
        <AllLlvmLibs>$(AllLlvmLibs);LLVMLinker.lib</AllLlvmLibs>
        <AllLlvmLibs>$(AllLlvmLibs);LLVMLTO.lib</AllLlvmLibs>
        <AllLlvmLibs>$(AllLlvmLibs);LLVMMSSupport.lib</AllLlvmLibs>
        <AllLlvmLibs>$(AllLlvmLibs);LLVMOption.lib</AllLlvmLibs>
        <AllLlvmLibs>$(AllLlvmLibs);LLVMPasses.lib</AllLlvmLibs>
        <AllLlvmLibs>$(AllLlvmLibs);LLVMPassPrinters.lib</AllLlvmLibs>
        <AllLlvmLibs>$(AllLlvmLibs);LLVMProfileData.lib</AllLlvmLibs>
        <AllLlvmLibs>$(AllLlvmLibs);LLVMScalarOpts.lib</AllLlvmLibs>
        <AllLlvmLibs>$(AllLlvmLibs);LLVMSupport.lib</AllLlvmLibs>
        <AllLlvmLibs>$(AllLlvmLibs);LLVMTableGen.lib</AllLlvmLibs>
        <AllLlvmLibs>$(AllLlvmLibs);LLVMTarget.lib</AllLlvmLibs>
        <AllLlvmLibs>$(AllLlvmLibs);LLVMTransformUtils.lib</AllLlvmLibs>
        <AllLlvmLibs>$(AllLlvmLibs);LLVMVectorize.lib</AllLlvmLibs>
    </PropertyGroup>
    <ItemDefinitionGroup>
        <ClCompile>
            <AdditionalOptions>%(AdditionalOptions) /Zc:sizedDealloc-</AdditionalOptions>
            <DisableSpecificWarnings>4141;4146;4267;4244;4800;4291;4996;4624;%(DisableSpecificWarnings)</DisableSpecificWarnings>
            <AdditionalIncludeDirectories>$(LlvmCommonIncRoot);$(LlvmPlatformConfigIncRoot);$(LlvmExecutionEngineOrcRoot)%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>
        </ClCompile>
    </ItemDefinitionGroup>
    <ItemDefinitionGroup>
        <!--
        The total number of libs and full path from the MSBuild item will generate insanely long command
        line arguments. (So much so that it actually exceeds the length limits for the linker response file designed
        to handle longer command lines!) This resolves the length by listing only the base file name and adding
        the directory to the list of library paths.
        -->
        <Link>
            <AdditionalLibraryDirectories>$(LlvmPlatformConfigLibRoot);%(Link.AdditionalLibraryDirectories)</AdditionalLibraryDirectories>
            <AdditionalDependencies>$(AllLlvmLibs);%(Link.AdditionalDependencies)</AdditionalDependencies>
        </Link>
    </ItemDefinitionGroup>
</Project>
